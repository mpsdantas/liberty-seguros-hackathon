<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="fragments/sistema/layout::head(pageTitle='Liberty-se - Dashboard')">
</head>
<link th:href=@{/assets/plugins/jquery.steps-1.1.0/jquery.steps.css} rel="stylesheet"/>
<link th:href=@{/assets/plugins/select2/css/select2.css} rel="stylesheet"/>
<link rel="stylesheet" type="text/css" th:href=@{https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css}/>
<style>
    .wizard > .content > .body {
        float: left;
        position: relative;
        width: 95%;
        height: 95%;
        padding: 2.5%;
    }

     input[type="range"]{
         -webkit-appearance: none;
         -moz-apperance: none;
         border-radius: 6px;
         height: 6px;
         background-image: -webkit-gradient(
                 linear,
                 left top,
                 right top,
                 color-stop(0.15, #94A14E),
                 color-stop(0.15, #C5C5C5)
         );
     }

    input[type='range']::-webkit-slider-thumb {
        -webkit-appearance: none !important;
        background-color: #E9E9E9;
        border: 1px solid #CECECE;
        height: 15px;
        width: 15px;
    }

</style>
<body class="sidebar-fixed sidebar-dark header-light header-fixed" id="body">
<div class="mobile-sticky-body-overlay"></div>
<div class="wrapper">
    <aside class="left-sidebar bg-sidebar" th:replace="fragments/sistema/layout::menu"></aside>

    <div class="page-wrapper">
       <header class="main-header " id="header"
               th:replace="fragments/sistema/layout::header(usuario='Marcus', email='mpsdantas15@gmail.com')"></header>

      	<!--CONTEUDO DA PÁGINA-->
		<div class="content-wrapper">
        	<div class="content">	
		        <div class="row">
		            <div class="col-12">
		                <div class="card card-table-border-none" id="recent-orders">
		                    <div class="card-header justify-content-between">
		                        <h1>Cotação</h1>
		                    </div>
		                    <div class="card-body pt-0 pb-5">
		                        <div class="card-body">
		                            <form id="wizard" th:action="@{/cotacao/cadastrar}" method="POST">
		                                <div>
		                                    <h3>Seguradoras</h3>
		                                    <section>
		                                        <div th:replace="sistema/seguradoras"></div>
		                                    </section>
		                                    <h3>Segurado</h3>
		                                    <section>
		                                        <label class="text-dark font-weight-medium" for="">Nome</label>
		                                        <div class="form-group" >
		                                            <select name="client_id" id="client" class="form-control" th:field="${cotacao.cotacao.cliente}">
		                                                <option th:each="client: ${clientes}" th:value="${client.code}" th:text="${client.name}"></option>
		                                            </select>
		                                        </div>
		                                        <div class="form-group">
		                                            <label for="ramo">Ramo</label>
		                                            <select th:field="${cotacao.cotacao.ramo}" class="form-control" name="cotacao.ramo" id="ramo">
		                                                <option value="1"> Nenhum</option>
		                                                <option value="automovel">AUTOMÓVEL</option>
		                                                <option value="patrimonio">PATRIMONIAL - RESIDENCIAL</option>
		                                                <option value="vida">VIDA INDIVIDUAL</option>
		                                                <option value="saude">SAÚDE</option>
		                                            </select>
		                                        </div>
		                                        <div class="row">
		                                            <div class="col-md-6">
		                                                <div class="form-group">
		                                                    <label for="inicioVigencia">Vigência - início</label>
		                                                    <input type="date" name="inicioVigencia" class="form-control"
		                                                           id="inicioVigencia">
		                                                </div>
		                                            </div>
		                                            <div class="col-md-6">
		                                                <div class="form-group">
		                                                    <label for="fimVigencia">Vigência - fim</label>
		                                                    <input type="date" name="fimVigencia" class="form-control"
		                                                           id="fimVigencia">
		                                                </div>
		                                            </div>
		                                        </div>
		                                    </section>
		                                    <h3>Informações</h3>
		                                    <section>
		                                        <div th:replace="cotacao/seguros/automovel"></div>
		                                        <div th:replace="cotacao/seguros/patrimonial"></div>
		                                        <div th:replace="cotacao/seguros/vida"></div>
		                                        <div th:replace="cotacao/seguros/saude"></div>
		
		                                    </section>
		                                </div>
		                            </form>
		
		                        </div>
		                    </div>
		                </div>
		                
		               </div>
		       </div>
		    </div>
		</div>
       
    	<div class="content-wrapper" style="display:none" id="resultado-cotacoes">
          <div class="content">	
                <div class="card card-table-border-none">
                    <div class="card-header justify-content-between">
                      <h3>Resultado da Consulta de Cotação</h3>
                    </div>
                    <div class="card-body pt-0 pb-5">
                      <div class="table-responsive">
                      <table class="table card-table table-responsive table-responsive-large" style="width:100%">
                        <thead>
                          <tr>
                            <th class="text-dark">Seguradora</th>
                            <th class="text-dark">Comissão</th>
                            <th class="text-dark d-none d-md-table-cell">Valor</th>
                            <th class="text-dark">Status</th>
                            <th>Coberturas</th>
                            <th></th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td >Liberty Seguros</td>
                            <td>
                            <div class="col-sm-6 my-1">
		                            	<input value="15%" type="text" class="form-control form-control-sm" aria-label="Porcentagem da comissão">
							</div>
                            <td class="text-dark">R$ 25.000,00</td>
                            <td >
                              <span class="badge badge-success">Mais popular</span>
                            </td>
                            <td><p>
                            DC: R$ 21.000,00<br/>
                            DM: R$ 31.000,00
                            </p>
                            </td>
                            <td class="text-right">
                              <div class="dropdown show d-inline-block widget-dropdown">
                                <a class="dropdown-toggle icon-burger-mini" href="" role="button" id="dropdown-recent-order1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static"></a>
                                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown-recent-order1">
                                  <li class="dropdown-item">
                                    <a href="#">View</a>
                                  </li>
                                  <li class="dropdown-item">
                                    <a href="#">Remove</a>
                                  </li>
                                </ul>
                              </div>
                            </td>
                          </tr>
                          
                          <tr>
                            <td >Azul Seguros</td>
                            <td>
                            <div class="col-sm-6 my-1">
		                            	<input value="20%" type="text" class="form-control form-control-sm" aria-label="Porcentagem da comissão">
							</div>
                            <td class="text-dark">R$ 44.000,00</td>
                            <td >
                              <span class="badge badge-warning">Alto</span>
                            </td>
                            <td><p>
                            DC: R$ 35.000,00<br/>
                            DM: R$ 47.000,00
                            </p>
                            </td>
                            <td class="text-right">
                              <div class="dropdown show d-inline-block widget-dropdown">
                                <a class="dropdown-toggle icon-burger-mini" href="" role="button" id="dropdown-recent-order1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static"></a>
                                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown-recent-order1">
                                  <li class="dropdown-item">
                                    <a href="#">View</a>
                                  </li>
                                  <li class="dropdown-item">
                                    <a href="#">Remove</a>
                                  </li>
                                </ul>
                              </div>
                            </td>
                          </tr>
                          
                          <tr>
                            <td >Caixa</td>
                            <td>
                            <div class="col-sm-6 my-1">
		                            	<input value="17%" type="text" class="form-control form-control-sm" aria-label="Porcentagem da comissão">
							</div>
                            <td class="text-dark">R$ 32.000,00</td>
                            <td >
                              <span class="badge badge-secondary">Regular</span>
                            </td>
                            <td><p>
                            DC: R$ 27.000,00<br/>
                            DM: R$ 33.000,00
                            </p>
                            </td>
                            <td class="text-right">
                              <div class="dropdown show d-inline-block widget-dropdown">
                                <a class="dropdown-toggle icon-burger-mini" href="" role="button" id="dropdown-recent-order1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static"></a>
                                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown-recent-order1">
                                  <li class="dropdown-item">
                                    <a href="#">View</a>
                                  </li>
                                  <li class="dropdown-item">
                                    <a href="#">Remove</a>
                                  </li>
                                </ul>
                              </div>
                            </td>
                          </tr>
                          
                          <tr>
                            <td >Itaú Seguros</td>
                            <td>
                            <div class="col-sm-6 my-1">
		                            	<input value="21%" type="text" class="form-control form-control-sm" aria-label="Porcentagem da comissão">
							</div>
                            <td class="text-dark">R$ 50.000,00</td>
                            <td >
                              <span class="badge badge-danger">Muito Alto</span>
                            </td>
                            <td><p>
                            DC: R$ 48.000,00<br/>
                            DM: R$ 56.000,00
                            </p>
                            </td>
                            <td class="text-right">
                              <div class="dropdown show d-inline-block widget-dropdown">
                                <a class="dropdown-toggle icon-burger-mini" href="" role="button" id="dropdown-recent-order1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static"></a>
                                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown-recent-order1">
                                  <li class="dropdown-item">
                                    <a href="#">View</a>
                                  </li>
                                  <li class="dropdown-item">
                                    <a href="#">Remove</a>
                                  </li>
                                </ul>
                              </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                      </div>
                    </div>
                  </div>
              </div>
         </div>
                
        <!--CONTEUDO DA PÁGINA-->
        <footer class="footer mt-auto" th:replace="fragments/sistema/layout::footer">
        </footer>
        <div th:replace="fragments/sistema/layout::scripts">
        </div>
        <script th:src=@{/assets/plugins/jquery.steps-1.1.0/jquery.steps.min.js}></script>
        <script th:src=@{/assets/plugins/select2/js/select2.full.js}></script>

        <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
        <script type="text/javascript"
                src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

        <script>
            var picker = $('input[name*=Vigencia]').daterangepicker({
                format: 'dd/mm/yyyy',
                dateFormat: 'dd/mm/yyyy'
            });

            $(document).ready(function () {
                var form = $("#wizard")
                form.children("div").steps({
                    headerTag: "h3",
                    bodyTag: "section",
                    transitionEffect: "slideLeft",
                    onStepChanging: function (event, currentIndex, newIndex) {
                        //form.validate().settings.ignore = ":disabled,:hidden"

                        if (currentIndex === 1 )
                            return $("#ramo").val() != 1;
                        return true;

                    },
                    onFinishing: function (event, currentIndex) {
                        //form.validate().settings.ignore = ":disabled";
                        return true;
                    },
                    onFinished: function (event, currentIndex) {
                    	$('#resultado-cotacoes').css('display', 'flex');
                    	$([document.documentElement, document.body]).animate({
                            scrollTop: $("#resultado-cotacoes").offset().top
                        }, 1000);
                        //$('#wizard').submit()
                    },
                    labels: {
                        current: "current step:",
                        pagination: "Paginação",
                        finish: "Cálcular",
                        next: "Próximo",
                        previous: "Anterior",
                        loading: "Carregando ..."
                    }
                });
                var ramos = ['saude', 'vida', 'patrimonial', 'automovel'];
                $('#ramo').on('change', function () {
                    var selected = $(this).val()
                    //exibe campos do ramo selecionado
                    if (selected !== 1) {
                        ramos.forEach(function (value) {
                            if (value !== selected)
                                $('.' + value).hide();
                            else
                                $('.' + value).show();
                        })
                    }
                })


                $('input[name^=comissoes]').change(function () {
                    $('input[name^=comissoes]').map(function(idx, elem) {
                        var text = $(elem).val() + "%";
                        $(elem).closest('div').find('div').text(text);
                    });


                    $('input[name^=comissoes]').map(function(idx, elem) {

                        var val = ($(elem).val() - 1)/ 99.0;
                        $(elem).css('background-image',
                            '-webkit-gradient(linear, left top, right top, '
                            + 'color-stop(' + val + ', #94A14E), '
                            + 'color-stop(' + val + ', #C5C5C5)'
                            + ')'
                        );
                    });


                });
            });


        </script>
    </div>
</div>
</body>
</html>
